<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Generated by Caltrop Parser version 1.2 -->
<Actor name="dequant">
    <Import kind="package">
        <QID name="caltrop.lib.BitOps">
            <ID name="caltrop"/>
            <ID name="lib"/>
            <ID name="BitOps"/>
        </QID>
    </Import>
    <Port kind="Input" name="IN">
        <Type name="List">
            <Entry kind="Type">
                <Type name="int"/>
            </Entry>
        </Type>
    </Port>
    <Port kind="Input" name="FLAGS">
        <Type name="int"/>
    </Port>
    <Port kind="Output" name="OUT">
        <Type name="List">
            <Entry kind="Type">
                <Type name="int"/>
            </Entry>
        </Type>
    </Port>
    <Port kind="Output" name="DC">
        <Type name="int"/>
    </Port>
    <Port kind="Output" name="MIN">
        <Type name="int"/>
    </Port>
    <Decl kind="Variable" name="saturate">
        <Type kind="Function" infer="true"/>
        <Expr kind="Lambda">
            <Decl kind="Parameter" name="x"/>
            <Expr kind="If">
                <Expr kind="BinOpSeq">
                    <Expr kind="Var" name="x"/>
                    <Op name="&lt;"/>
                    <Expr kind="UnaryOp">
                        <Op name="-"/>
                        <Expr kind="Literal" literal-kind="Integer" value="2048"/>
                    </Expr>
                </Expr>
                <Expr kind="UnaryOp">
                    <Op name="-"/>
                    <Expr kind="Literal" literal-kind="Integer" value="2048"/>
                </Expr>
                <Expr kind="If">
                    <Expr kind="BinOpSeq">
                        <Expr kind="Var" name="x"/>
                        <Op name="&gt;"/>
                        <Expr kind="Literal" literal-kind="Integer" value="2047"/>
                    </Expr>
                    <Expr kind="Literal" literal-kind="Integer" value="2047"/>
                    <Expr kind="Var" name="x"/>
                </Expr>
            </Expr>
        </Expr>
    </Decl>
    <Decl kind="Variable" name="limit">
        <Type kind="Function" infer="true"/>
        <Expr kind="Lambda">
            <Decl kind="Parameter" name="x"/>
            <Decl kind="Parameter" name="max"/>
            <Expr kind="If">
                <Expr kind="BinOpSeq">
                    <Expr kind="Var" name="x"/>
                    <Op name="&gt;"/>
                    <Expr kind="Var" name="max"/>
                </Expr>
                <Expr kind="Var" name="max"/>
                <Expr kind="Var" name="x"/>
            </Expr>
        </Expr>
    </Decl>
    <Decl kind="Variable" name="deq">
        <Type kind="Function" infer="true" name="List"/>
        <Expr kind="Lambda">
            <Decl kind="Parameter" name="v">
	        <Type name="List"/>
            </Decl>
            <Decl kind="Parameter" name="QP"/>
            <Decl kind="Parameter" name="scale"/>
            <Decl kind="Parameter" name="r"/>
            <Expr kind="List">
                <Expr kind="If">
                    <Expr kind="BinOpSeq">
                        <Expr kind="Application">
                            <Expr kind="Entry" name="get">
                                <Expr kind="Var" name="v"/>
                            </Expr>
                            <Args>
                                <Expr kind="Var" name="i"/>
                            </Args>
                        </Expr>
                        <Op name="="/>
                        <Expr kind="Literal" literal-kind="Integer" value="0"/>
                    </Expr>
                    <Expr kind="Literal" literal-kind="Integer" value="0"/>
                    <Expr kind="If">
                        <Expr kind="BinOpSeq">
                            <Expr kind="Var" name="i"/>
                            <Op name="="/>
                            <Expr kind="Literal" literal-kind="Integer" value="0"/>
                            <Op name="and"/>
                            <Expr kind="Var" name="scale"/>
                            <Op name="!="/>
                            <Expr kind="Literal" literal-kind="Integer" value="0"/>
                        </Expr>
                        <Expr kind="Application">
                            <Expr kind="Var" name="saturate"/>
                            <Args>
                                <Expr kind="Application">
                                    <Expr kind="Entry" name="get">
                                        <Expr kind="Var" name="v"/>
                                    </Expr>
                                    <Args>
                                        <Expr kind="Literal" literal-kind="Integer" value="0"/>
                                    </Args>
                                </Expr>
                            </Args>
                        </Expr>
                        <Expr kind="If">
                            <Expr kind="BinOpSeq">
                                <Expr kind="Application">
                                    <Expr kind="Entry" name="get">
                                        <Expr kind="Var" name="v"/>
                                    </Expr>
                                    <Args>
                                        <Expr kind="Var" name="i"/>
                                    </Args>
                                </Expr>
                                <Op name="&lt;"/>
                                <Expr kind="Literal" literal-kind="Integer" value="0"/>
                            </Expr>
                            <Expr kind="UnaryOp">
                                <Op name="-"/>
                                <Expr kind="Application">
                                    <Expr kind="Var" name="limit"/>
                                    <Args>
                                        <Expr kind="BinOpSeq">
                                            <Expr kind="Var" name="QP"/>
                                            <Op name="*"/>
                                            <Expr kind="BinOpSeq">
                                                <Expr kind="BinOpSeq">
                                                    <Expr kind="UnaryOp">
                                                        <Op name="-"/>
                                                        <Expr kind="Application">
                                                            <Expr kind="Entry" name="get">
                                                                <Expr kind="Var" name="v"/>
                                                            </Expr>
                                                            <Args>
                                                                <Expr kind="Var" name="i"/>
                                                            </Args>
                                                        </Expr>
                                                    </Expr>
                                                    <Op name="*"/>
                                                    <Expr kind="Literal" literal-kind="Integer" value="2"/>
                                                </Expr>
                                                <Op name="+"/>
                                                <Expr kind="Literal" literal-kind="Integer" value="1"/>
                                            </Expr>
                                            <Op name="-"/>
                                            <Expr kind="Var" name="r"/>
                                        </Expr>
                                        <Expr kind="Literal" literal-kind="Integer" value="2048"/>
                                    </Args>
                                </Expr>
                            </Expr>
                            <Expr kind="Application">
                                <Expr kind="Var" name="limit"/>
                                <Args>
                                    <Expr kind="BinOpSeq">
                                        <Expr kind="Var" name="QP"/>
                                        <Op name="*"/>
                                        <Expr kind="BinOpSeq">
                                            <Expr kind="BinOpSeq">
                                                <Expr kind="Application">
                                                    <Expr kind="Entry" name="get">
                                                        <Expr kind="Var" name="v"/>
                                                    </Expr>
                                                    <Args>
                                                        <Expr kind="Var" name="i"/>
                                                    </Args>
                                                </Expr>
                                                <Op name="*"/>
                                                <Expr kind="Literal" literal-kind="Integer" value="2"/>
                                            </Expr>
                                            <Op name="+"/>
                                            <Expr kind="Literal" literal-kind="Integer" value="1"/>
                                        </Expr>
                                        <Op name="-"/>
                                        <Expr kind="Var" name="r"/>
                                    </Expr>
                                    <Expr kind="Literal" literal-kind="Integer" value="2047"/>
                                </Args>
                            </Expr>
                        </Expr>
                    </Expr>
                </Expr>
                <Generator>
                    <Decl kind="Generator" name="i"/>
                    <Expr kind="Application">
                        <Expr kind="Var" name="Integers"/>
                        <Args>
                            <Expr kind="Literal" literal-kind="Integer" value="0"/>
                            <Expr kind="Literal" literal-kind="Integer" value="63"/>
                        </Args>
                    </Expr>
                </Generator>
            </Expr>
        </Expr>
    </Decl>
    <Action text-begin-line="41" text-begin-col="10" text-end-line="48" text-end-col="3">
        <QID name="inter">
            <ID name="inter"/>
        </QID>
        <Input kind="Elements" port="IN">
            <Decl kind="Input" name="d"/>
        </Input>
        <Input kind="Elements" port="FLAGS">
            <Decl kind="Input" name="type"/>
            <Decl kind="Input" name="q"/>
            <Decl kind="Input" name="scaler"/>
        </Input>
        <Output port="OUT">
            <Expr kind="Application">
                <Expr kind="Var" name="deq"/>
                <Args>
                    <Expr kind="Var" name="d"/>
                    <Expr kind="Var" name="q"/>
                    <Expr kind="Var" name="scaler"/>
                    <Expr kind="Var" name="round"/>
                </Args>
            </Expr>
        </Output>
        <Output port="MIN">
            <Expr kind="If">
                <Expr kind="BinOpSeq">
                    <Expr kind="Var" name="scaler"/>
                    <Op name="="/>
                    <Expr kind="Literal" literal-kind="Integer" value="0"/>
                </Expr>
                <Expr kind="UnaryOp">
                    <Op name="-"/>
                    <Expr kind="Literal" literal-kind="Integer" value="256"/>
                </Expr>
                <Expr kind="Literal" literal-kind="Integer" value="0"/>
            </Expr>
        </Output>
        <Guards>
            <Expr kind="BinOpSeq">
                <Expr kind="Var" name="type"/>
                <Op name="="/>
                <Expr kind="Literal" literal-kind="Integer" value="1"/>
            </Expr>
        </Guards>
        <Decl kind="Variable" name="round">
            <Type name="int"/>
            <Expr kind="Application">
                <Expr kind="Var" name="bitxor"/>
                <Args>
                    <Expr kind="Application">
                        <Expr kind="Var" name="bitand"/>
                        <Args>
                            <Expr kind="Var" name="q"/>
                            <Expr kind="Literal" literal-kind="Integer" value="1"/>
                        </Args>
                    </Expr>
                    <Expr kind="Literal" literal-kind="Integer" value="1"/>
                </Args>
            </Expr>
        </Decl>
    </Action>
    <Action text-begin-line="50" text-begin-col="10" text-end-line="58" text-end-col="3">
        <QID name="intra">
            <ID name="intra"/>
        </QID>
        <Input kind="Elements" port="IN">
            <Decl kind="Input" name="d"/>
        </Input>
        <Input kind="Elements" port="FLAGS">
            <Decl kind="Input" name="type"/>
            <Decl kind="Input" name="q"/>
            <Decl kind="Input" name="scaler"/>
        </Input>
        <Output port="OUT">
            <Expr kind="Var" name="dd"/>
        </Output>
        <Output port="DC">
            <Expr kind="Application">
                <Expr kind="Entry" name="get">
                    <Expr kind="Var" name="dd"/>
                </Expr>
                <Args>
                    <Expr kind="Literal" literal-kind="Integer" value="0"/>
                </Args>
            </Expr>
        </Output>
        <Output port="MIN">
            <Expr kind="If">
                <Expr kind="BinOpSeq">
                    <Expr kind="Var" name="scaler"/>
                    <Op name="="/>
                    <Expr kind="Literal" literal-kind="Integer" value="0"/>
                </Expr>
                <Expr kind="UnaryOp">
                    <Op name="-"/>
                    <Expr kind="Literal" literal-kind="Integer" value="256"/>
                </Expr>
                <Expr kind="Literal" literal-kind="Integer" value="0"/>
            </Expr>
        </Output>
        <Guards>
            <Expr kind="BinOpSeq">
                <Expr kind="Var" name="type"/>
                <Op name="="/>
                <Expr kind="Literal" literal-kind="Integer" value="0"/>
            </Expr>
        </Guards>
        <Decl kind="Variable" name="round">
            <Type name="int"/>
            <Expr kind="Application">
                <Expr kind="Var" name="bitxor"/>
                <Args>
                    <Expr kind="Application">
                        <Expr kind="Var" name="bitand"/>
                        <Args>
                            <Expr kind="Var" name="q"/>
                            <Expr kind="Literal" literal-kind="Integer" value="1"/>
                        </Args>
                    </Expr>
                    <Expr kind="Literal" literal-kind="Integer" value="1"/>
                </Args>
            </Expr>
        </Decl>
        <Decl kind="Variable" name="dd">
            <Type name="List">
                <Entry kind="Type">
                    <Type name="int"/>
                </Entry>
            </Type>
            <Expr kind="Application">
                <Expr kind="Var" name="deq"/>
                <Args>
                    <Expr kind="Var" name="d"/>
                    <Expr kind="Var" name="q"/>
                    <Expr kind="Var" name="scaler"/>
                    <Expr kind="Var" name="round"/>
                </Args>
            </Expr>
        </Decl>
    </Action>
</Actor>
